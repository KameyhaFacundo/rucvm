<?php namespace Models1;
include_once 'conexion.php';
	class Ficha31{
		private $idficha31;
		private $idficha;
		private $v_fisica;
		private $v_psicologica;
		private $v_sexual;
		private $v_economica;
		private $v_parsocial;
		private $v_simbolica;
		private $co_obstaculo;
		private $co_econo;
		private $fecha1;
		private $fecha2;
		//reincidencia
		private $r_v_fisica;
		private $r_v_psicologica;
		private $r_v_sexual;
		private $r_v_economica;
		private $r_v_parsocial;
		private $r_v_simbolica;
		private $r_co_obstaculo;
		private $r_co_econo;

		public function __construct(){

		}

		public function set($atributo, $contenido){
			$this->$atributo = $contenido;
		}

		public function get($atributo){
			return $this->$atributo;
		}

		public function agregarFicha31(){
			        $this->v_parsocial = !empty($this->v_parsocial) ? $this->v_parsocial : "NULL";
                    $this->v_simbolica = !empty($this->v_simbolica) ? $this->v_simbolica : "NULL";
                    $this->co_obstaculo = !empty($this->co_obstaculo) ? $this->co_obstaculo : "NULL";
                    $this->co_econo = !empty($this->co_econo) ? $this->co_econo : "NULL";
                        $con = new Conexion();
			$sql = "INSERT INTO ficha31(idficha, v_fisica, v_psicologica, v_sexual, v_economica, v_parsocial, v_simbolica, co_obstaculo, co_econo) VALUES ({$this->idficha}, {$this->v_fisica}, {$this->v_psicologica}, {$this->v_sexual}, {$this->v_economica}, {$this->v_parsocial}, {$this->v_simbolica}, {$this->co_obstaculo}, {$this->co_econo})";
			$con->consultaSimple($sql);
			//echo $sql;
		}

		public function eliminarFicha31(){
			$sql = "DELETE FROM ficha31 WHERE idficha31 = {$this->idficha31}";
			$this->con->consultaSimple($sql);
		}

		public function updateFicha31(){
			        $this->v_parsocial = !empty($this->v_parsocial) ? $this->v_parsocial : "NULL";
                    $this->v_simbolica = !empty($this->v_simbolica) ? $this->v_simbolica : "NULL";
                    $this->co_obstaculo = !empty($this->co_obstaculo) ? $this->co_obstaculo : "NULL";
                    $this->co_econo = !empty($this->co_econo) ? $this->co_econo : "NULL";
                        $con = new Conexion();
			$sql = "UPDATE ficha31 SET v_fisica = {$this->v_fisica}, v_psicologica = {$this->v_psicologica}, v_sexual = {$this->v_sexual}, v_economica = {$this->v_economica}, v_parsocial = {$this->v_parsocial}, v_simbolica = {$this->v_simbolica}, co_obstaculo = {$this->co_obstaculo}, co_econo = {$this->co_econo} WHERE idficha = {$this->idficha}";
			$con->consultaSimple($sql);
		}

		public function verFicha31(){
                        $con = new Conexion();
			$sql = "SELECT * FROM ficha31 WHERE idficha = {$this->idficha}";
			$datos = $con->consultaRetorno($sql);
			$row = pg_fetch_assoc($datos);
			return $row;
		}

		public function tipo_violencia(){
            $con = new Conexion();
			$sql = "SELECT (SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fisica, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psicologica, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sexual, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as simbolica,
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as economica,
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as parsocial, 
					(SELECT COUNT(ficha.per_dni) FROM ficha, institucion, usuarios WHERE ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as total,
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS pfisica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS ppsicologica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS psexual,
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS psimbolica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS peconomica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS pparsocial, 
					institucion.ins_descripcion
					FROM ficha31, ficha, institucion, usuarios

					WHERE ficha31.idficha = ficha.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}' GROUP BY institucion.ins_descripcion";
			$datos = $con->consultaRetorno($sql);
			return $datos;
		}

		public function can_violencias(){
            $con = new Conexion();
			$sql = "CREATE OR REPLACE VIEW dos_casos as SELECT ficha.per_dni, (ficha31.v_fisica+ficha31.v_economica+ficha31.v_parsocial+	ficha31.v_psicologica+ficha31.v_sexual+ficha31.v_simbolica ) as suma, institucion.ins_descripcion
					FROM ficha, ficha31, institucion, usuarios
					WHERE ficha.idficha = ficha31.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'; 
					SELECT (SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 12) as ninguna,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 11) as una,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 10) as dos,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 9) as tres,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 8) as cuatro,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 7) as cinco,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 6) as seis,
					(SELECT COUNT(dos_casos.per_dni) FROM dos_casos) as total,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 12)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS pninguna,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 11)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS puna, 
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 10)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS pdos,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 9)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS ptres,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 8)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS pcuatro,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 7)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS pcinco,
					(round((SELECT COUNT(dos_casos.per_dni) FROM dos_casos WHERE dos_casos.suma = 6)/(SELECT COUNT(dos_casos.per_dni) FROM dos_casos)::numeric,3))*100 AS pseis, dos_casos.ins_descripcion
					FROM dos_casos, ficha
					WHERE ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}' GROUP BY dos_casos.ins_descripcion";
			$datos = $con->consultaRetorno($sql);
			return $datos;
		}

		public function com_violencias(){
            $con = new Conexion();
			$sql = "SELECT 
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_rps_sim,					
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_rps_sim

					FROM ficha, ficha31, institucion, usuarios
					WHERE ficha.idficha = ficha31.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND institucion.idinstitucion = ". $_SESSION['idinstitucion'] ." AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'";
			$datos = $con->consultaRetorno($sql);
			return $datos;
		}

		public function updateFicha31Reincidencia(){
				    $this->v_parsocial = !empty($this->v_parsocial) ? $this->v_parsocial : "NULL";
                    $this->v_simbolica = !empty($this->v_simbolica) ? $this->v_simbolica : "NULL";
                    $this->r_co_obstaculo = !empty($this->r_co_obstaculo) ? $this->r_co_obstaculo : "NULL";
                    $this->r_co_econo = !empty($this->r_co_econo) ? $this->r_co_econo : "NULL";
            $con = new Conexion();
			$sql = "UPDATE ficha31 SET r_v_fisica = {$this->r_v_fisica}, r_v_psicologica = {$this->r_v_psicologica}, r_v_sexual = {$this->r_v_sexual}, r_v_economica = {$this->r_v_economica}, r_v_parsocial = {$this->r_v_parsocial}, r_v_simbolica = {$this->r_v_simbolica}, r_co_obstaculo = {$this->r_co_obstaculo}, r_co_econo = {$this->r_co_econo} WHERE idficha = {$this->idficha}";
			//echo $sql;
			$con->consultaSimple($sql);
		}

		public function tipo_violenciaDep(){
            $con = new Conexion();
			$sql = "SELECT (SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fisica, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psicologica, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sexual, 
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as simbolica,
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as economica,
					(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as parsocial, 
					(SELECT COUNT(ficha.per_dni) FROM ficha, institucion, usuarios WHERE ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as total,
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS pfisica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS ppsicologica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS psexual,
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS psimbolica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS peconomica, 
					(round((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')/((SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_psicologica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_sexual = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_simbolica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_parsocial = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}')+(SELECT COUNT(ficha.per_dni) as consultantes FROM ficha, ficha31, institucion, usuarios WHERE ficha31.idficha = ficha.idficha AND ficha31.v_economica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'))::numeric,3))*100 AS pparsocial, 
					institucion.ins_descripcion
					FROM ficha31, ficha, institucion, usuarios

					WHERE ficha31.idficha = ficha.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}' GROUP BY institucion.ins_descripcion";
			$datos = $con->consultaRetorno($sql);
			return $datos;
		}

		public function can_violenciasDep(){
            $con = new Conexion();
			$sql = "CREATE OR REPLACE VIEW dos_casos_dep as SELECT ficha.per_dni, (ficha31.v_fisica+ficha31.v_economica+ficha31.v_parsocial+	ficha31.v_psicologica+ficha31.v_sexual+ficha31.v_simbolica ) as suma
					FROM ficha, ficha31, institucion, usuarios
					WHERE ficha.idficha = ficha31.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'"; 
			$con->consultaSimple($sql);
			$sql1 ="SELECT (SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 12) as ninguna,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 11) as una,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 10) as dos,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 9) as tres,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 8) as cuatro,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 7) as cinco,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 6) as seis,
					(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep) as total,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 12)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS pninguna,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 11)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS puna, 
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 10)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS pdos,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 9)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS ptres,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 8)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS pcuatro,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 7)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS pcinco,
					(round((SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep WHERE dos_casos_dep.suma = 6)/(SELECT COUNT(dos_casos_dep.per_dni) FROM dos_casos_dep)::numeric,3))*100 AS pseis
					FROM dos_casos_dep, ficha
					WHERE ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'";
			$datos = $con->consultaRetorno($sql1);
			return $datos;
		}

		public function com_violenciasDep(){
            $con = new Conexion();
			$sql = "SELECT 
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_sex,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as eco_rps_sim,					
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 2 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_rps,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 2 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 2 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 2 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 2 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 2 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as sex_psico_eco_rps_sim,
					(SELECT COUNT(ficha.per_dni) FROM ficha, ficha31, institucion, usuarios WHERE ficha.idficha = ficha31.idficha AND ficha31.v_psicologica = 1 AND ficha31.v_economica = 1 AND ficha31.v_sexual = 1 AND ficha31.v_simbolica = 1 AND ficha31.v_parsocial = 1 AND ficha31.v_fisica = 1 AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}') as fis_sex_psico_eco_rps_sim

					FROM ficha, ficha31, institucion, usuarios
					WHERE ficha.idficha = ficha31.idficha AND ficha.idusuario = usuarios.idusuario AND usuarios.idinstitucion = institucion.idinstitucion AND ficha.fec_consulta >= '{$this->fecha1}' AND ficha.fec_consulta <= '{$this->fecha2}'";
			$datos = $con->consultaRetorno($sql);
			return $datos;
		}
	}
?>